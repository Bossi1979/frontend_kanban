<div class="addTask">
    <header>
        <h3>Add Task</h3>
    </header>
    <form [formGroup]="addForm">
        <div class="formular">
            <div class="formLeft">
                <div class="formField">
                    <span>Title<span>*</span></span>
                    <div class="formInputs">
                        <div class="formInput">
                            <input type="text" placeholder="Title" class="width100" formControlName="title">
                        </div>
                    </div>
                </div>

                <div class="formField">
                    <span>Description</span>
                    <textarea class="formTextarea" placeholder="Enter a Desription"
                        formControlName="description"></textarea>
                </div>
                <div class="formField">
                    <span>Assigned to</span>
                    <div class="formInputs">
                        <div class="formInput">
                            <input type="text" value="Select contacts to assign" *ngIf="assignBtnDisabled"
                                (focus)="openAssignToDropdown()" formControlName="assignTo">
                            <input type="text" *ngIf="!assignBtnDisabled" formControlName="assignToSelect">
                            <img src="../../assets/img/add_task/arrow_drop_downaa.png"
                                [class.rotate180deg]="!assignBtnDisabled" style="cursor: pointer;"
                                (click)="toggleAssignToDropdown()">
                            <div class="dropAssign" *ngIf="!assignBtnDisabled">
                                <div *ngFor="let contact of data.assignedToList; let i = index;">
                                    <div class="contactLine">
                                        <div class="contactLineLeft">
                                            <div class="bage" [style.background-color]="contact.background_color">
                                                <span>{{contact.name_abbreviation}}</span>
                                            </div>
                                            <p>
                                                {{contact.username}} <span
                                                    *ngIf="data.loggedUserData[0].id == contact.id_user">(Du)</span>
                                            </p>
                                        </div>
                                        <input type="checkbox" [id]="'checked' + i"
                                            (click)="selectionCheckbox('checked' + i, i)"
                                            [checked]="data.assignedToList[i].checked">
                                    </div>

                                </div>
                            </div>
                        </div>

                    </div>
                </div>
                <div class="assignToList">
                    <div *ngFor="let contact of data.assignedToList; let i = index;">
                        <div class="bageItem" [style.background-color]="contact.background_color"
                            *ngIf="contact.checked">
                            <span>{{contact.name_abbreviation}}</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="dividerAdd"></div>
            <div class="formRight">
                <div class="formField">
                    <span class="head">Due Date<span>*</span></span>
                    <div class="formInputs">
                        <div class="formInput">
                            <input type="date" placeholder="text" class="width100" formControlName="dueDate">
                        </div>
                    </div>
                </div>
                <div class="prioBtnDiv">
                    <p>Prio</p>
                    <div class="prioBtnContent">
                        <div class="prioBtn" [class.urgentBtn]="!urgentSelected"
                            [class.urgentBtnSelected]="urgentSelected" (click)="selectedPrio(1)">
                            <p>Urgent</p>
                            <span class="material-symbols-outlined urgent">keyboard_double_arrow_up</span>
                        </div>
                        <div class="prioBtn" [class.mediumBtn]="!mediumSelected"
                            [class.mediumBtnSelected]="mediumSelected" (click)="selectedPrio(2)">
                            <p>Medium</p>
                            <span class="material-symbols-outlined medium">
                                equal
                            </span>
                        </div>
                        <div class="prioBtn" [class.lowBtn]="!lowSelected" [class.lowBtnSelected]="lowSelected"
                            (click)="selectedPrio(3)">
                            <p>Low</p>
                            <span class="material-symbols-outlined low">
                                keyboard_double_arrow_down
                            </span>
                        </div>
                    </div>
                </div>

                <div class="formField">
                    <span class="head">Category<span>*</span></span>
                    <div class="formInputs">
                        <div class="formInput">
                            <input type="text" placeholder="Select task category" formControlName="category"
                                (focus)="toogleCategoryDropdown()">
                            <img src="../../assets/img/add_task/arrow_drop_downaa.png"
                                [class.rotate180deg]="categoryDropdown" style="cursor: pointer;"
                                (click)="toogleCategoryDropdown()">

                            <div class="dropCategory" *ngIf="categoryDropdown">
                                <p (click)="setCategory('Technical Task')">Technical Task</p>
                                <p (click)="setCategory('User Story')">User Story</p>
                            </div>

                        </div>
                    </div>
                </div>
                <div class="formField">
                    <span class="head">Subtask</span>
                    <div class="formInputs">
                        <div class="formInput" >
                            <input type="text" placeholder="Add new subtask" formControlName="subtask" (focus)="subtaskSelection()" #subtaskInput (keyup)="btnPressed($event)">
                            <span class="material-symbols-outlined subtask" *ngIf="!subtaskEdit" (click)="activatedSubtaskEdit()">
                                add
                            </span>
                            <span class="material-symbols-outlined closeSubtask" *ngIf="subtaskEdit" (click)="closeAddSubtask()">
                                close
                            </span>
                            <div class="subtaskDivider" style="height: 24px; border-left: 1px solid #D1D1D1" *ngIf="subtaskEdit"></div>
                            <span class="material-symbols-outlined addSubtask" *ngIf="subtaskEdit" (click)="addSubtask()">
                                done
                            </span>
                        </div>
                    </div>
                    <div class="subtaskList">
                        <div class="subtaskItem" *ngFor="let item of subtasksList; let i= index;" (dblclick)="enableEdit()" [style.background-color]="backg">
                            <li *ngIf="!enabledEdit">
                                <span >{{item.subtask}}</span>
                            </li>
                            <input type="text" [value]="item.subtask" *ngIf="enabledEdit" [id]="'subInput' + i" (blur)="leaveItemEdit()">
                            <div class="icons" [style.background-color]="backg" *ngIf="enabledEdit">
                                <span class="material-symbols-outlined">edit</span>
                                <div class="subtaskDivider"></div>
                                <span class="material-symbols-outlined">delete</span>
                            </div>
                        </div>
                        
                    </div>
                </div>
            </div>

        </div>

        <div class="btnOuter">
            <p><span>*</span>This field is required</p>
            <div class="btnContent">

                <button class="secondaryBtn" type="button" (click)="clearForm()">
                    Clear
                    <span class="material-symbols-outlined">
                        close
                    </span>
                </button>
                <button type="button" [disabled]="!addForm.valid" [class.primaryBtn]="addForm.valid"
                    [class.disabledBtn]="!addForm.valid" (click)="createTask()">
                    Create Task
                    <span class="material-symbols-outlined">
                        done
                    </span>
                </button>
            </div>

        </div>




    </form>
</div>